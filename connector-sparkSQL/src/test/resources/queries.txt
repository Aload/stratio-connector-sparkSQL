#SELECT *  FROM tpc30.stock  LIMIT 100



#Q0 No funciona
#SELECT substr(c_state,1,1) AS country, count(*) AS numcust, sum(c_balance) AS totacctbal FROM ( SELECT avg(sub.c_balance) AS balance FROM tpcc.customer sub WHERE sub.c_balance > 0.00 AND substr(sub.c_phone,1,1) IN ['1','2','3','4','5','6','7'])  INNER JOIN tpcc.customer ON c_balance > y.balance  WHERE substr(c_phone,1,1) IN ['1','2','3','4','5','6','7'] GROUP BY substring(c_state,1,1) ORDER BY country

#Q1 despues de cambiar todos los catalogos me da un  java.lang.UnsupportedOperationException: Parquet does not support timestamp. See HIVE-6384

#select OL.ol_w_id,OL.ol_d_id,OL.ol_o_id,AVG_Amoun,avg(OL.ol_amount) as average from (select d_id,d_w_id, avg(ol_amount) as AVG_Amoun  from district D, order_line OL_A where D.d_id=OL_A.ol_d_id and D.d_w_id=OL_A.ol_w_id and d_id=3 and d_w_id=241 group by d_id,d_w_id ) A, order_line OL where A.d_id=OL.ol_d_id and A.d_w_id=OL.ol_w_id and OL.ol_d_id=3 and OL.ol_w_id=241 group by OL.ol_w_id,OL.ol_d_id,OL.ol_o_id,AVG_Amoun having avg(OL.ol_amount) > AVG_Amoun order by average desc

# Esta es la original
# select OL.ol_w_id,OL.ol_d_id,OL.ol_o_id,AVG_Amoun,avg(OL.ol_amount) as average from (select d_id,d_w_id, avg(ol_amount) as AVG_Amoun  from district D, tpcc.order_line OL_A where D.d_id=OL_A.ol_d_id and D.d_w_id=OL_A.ol_w_id and d_id=3 and d_w_id=241 group by d_id,d_w_id ) A, tpcc.order_line OL where A.d_id=OL.ol_d_id and A.d_w_id=OL.ol_w_id and OL.ol_d_id=3 and OL.ol_w_id=241 group by OL.ol_w_id,OL.ol_d_id,OL.ol_o_id,AVG_Amoun having avg(OL.ol_amount) > AVG_Amoun order by average desc


#Q3 "Thread-1" java.lang.UnsupportedOperationException: Parquet does not support timestamp. See HIVE-6384
# select c_d_id,c_credit,count(C_ID) from tpcc.customer,tpcc.orders where c_w_id=168 and c_d_id=o_d_id and c_w_id=o_w_id and o_c_id=c_id group by c_credit,c_d_id order by c_d_id, c_credit


#Q5 SOPORTADA!!
#select s_i_id,i_price, s_quantity, i_name,count(*) as numero_pedidos, sum(i_price*s_quantity) as venta_total from tpcc.stock, tpcc.item where i_id=s_i_id and i_name like 'af%' group by s_i_id,i_price, s_quantity, i_name order by venta_total desc LIMIT 100

#Q6 SOPORTADA!!
#SELECT s_w_id,count(*) FROM tpcc.stock where s_quantity>85 and  s_quantity <= 115 group by s_w_id

#Q7  Parquet does not support timestamp. See HIVE-6384
#select max(ol_amount) from tpcc.order_line

#Q8 Parquet does not support timestamp. See HIVE-6384
select max(ol_amount),max(ol_quantity) from tpcc.order_line2

#Q9  in thread "Thread-1" java.lang.UnsupportedOperationException: Parquet does not support timestamp. See HIVE-6384
SELECT day(h_date), avg(h_amount) FROM tpcc.history WHERE h_c_w_id=245 GROUP BY day(h_date) ORDER BY day(h_date)